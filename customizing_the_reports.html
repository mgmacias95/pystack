<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Changelog" href="changelog.html" /><link rel="prev" title="Analyzing core dumps" href="corefile.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.07.26 -->
        <title>Customizing the reports - pystack</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=362ab14a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="overview.html"><div class="brand">pystack</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="overview.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/logo.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="process.html">Analyzing processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="corefile.html">Analyzing core dumps</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Customizing the reports</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="customizing-the-reports">
<span id="id1"></span><h1>Customizing the reports<a class="headerlink" href="#customizing-the-reports" title="Permalink to this heading">#</a></h1>
<p>By default, PyStack will show you the Python stack trace for all threads registered with the interpreter, but this
might not be enough in some scenarios where more detailed information is needed. PyStack offers some customization options
to include more information in the report. These options are available whether analyzing live processes or core files.</p>
<section id="native-traces">
<h2>Native traces<a class="headerlink" href="#native-traces" title="Permalink to this heading">#</a></h2>
<p>Sometimes, having only the Python stack trace is not enough to understand what’s happening in the process,
especially when the interpreter is performing some internal operation or
when some C extension code is being executed. As in these cases the computations are being executed using
machine code, the Python stack trace will not show the most relevant information. Although it is possible to obtain native
stack traces using tools like <code class="docutils literal notranslate"><span class="pre">pstack</span></code> or <code class="docutils literal notranslate"><span class="pre">gdb</span></code>, these traces will not show the Python frames that happen between
the different native calls, making it very difficult to interpret the reported stack trace.</p>
<p>In these situations, the best possible view is a “merged” stack trace in which the native calls that are used to execute
Python code are substituted by the actual Python functions being executed. This means that instead of:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>...
(C) File &quot;Objects/call.c&quot;, line 411, in _PyFunction_Vectorcall (/usr/lib/libpython3.8.so.1.0)
(C) File &quot;Include/cpython/abstract.c&quot;, line 127, in _PyObject_Vectorcall (/usr/lib/libpython3.8.so.1.0)
(C) File &quot;Objects/ceval.c&quot;, line 123, in _PyEval_EvalFrameDefault (/usr/lib/libpython3.8.so.1.0)
(C) File &quot;Python/ceval.c&quot;, line 4963, in call_function (inlined) (/usr/lib/libpython3.8.so.1.0)
(C) File &quot;Modules/timemodule.c&quot;, line 338, in time_sleep (/usr/lib/libpython3.8.so.1.0)
(C) File &quot;Modules/timemodule.c&quot;, line 1866, in pysleep (inlined) (/usr/lib/libpython3.8.so.1.0)
(C) File &quot;???&quot;, line 0, in __select ()
</pre></div>
</div>
<p>you will see:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>...
(Python) File &quot;/test.py&quot;, line 14, in third_func
    time.sleep(1000)
(C) File &quot;Python/ceval.c&quot;, line 4963, in call_function (inlined) (/usr/lib/libpython3.8.so.1.0)
(C) File &quot;Modules/timemodule.c&quot;, line 338, in time_sleep (/usr/lib/libpython3.8.so.1.0)
(C) File &quot;Modules/timemodule.c&quot;, line 1866, in pysleep (inlined) (/usr/lib/libpython3.8.so.1.0)
(C) File &quot;???&quot;, line 0, in __select ()
</pre></div>
</div>
<p>which shows how the call to <code class="docutils literal notranslate"><span class="pre">time.sleep(1000)</span></code> invokes the internal calls to the internal C implementation of the <code class="docutils literal notranslate"><span class="pre">time</span></code> module,
ending with the call to <code class="docutils literal notranslate"><span class="pre">__select()</span></code> in <code class="docutils literal notranslate"><span class="pre">libc</span></code>. This shows you the full picture of what the full sequence of calls between Python
and native code is without losing any important details.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Native mode (actived using <code class="docutils literal notranslate"><span class="pre">--native</span></code>) requires the interpreter and C extensions and shared libraries to have debugging
symbols. If debugging symbols have been stripped it is possible that the displayed stack traces will be incomplete.</p>
</div>
<p>To get the merged native stack traces you can use the <code class="docutils literal notranslate"><span class="pre">--native</span></code> command line option:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ pystack remote 112 --native
Traceback for thread 112 [] (most recent call last):
    (C) File &quot;???&quot;, line 0, in _start ()
    (C) File &quot;???&quot;, line 0, in __libc_start_main ()
    (C) File &quot;Modules/main.c&quot;, line 743, in Py_BytesMain (/usr/lib/libpython3.8.so.1.0)
    (C) File &quot;Modules/main.c&quot;, line 689, in Py_RunMain (/usr/lib/libpython3.8.so.1.0)
    (C) File &quot;Modules/main.c&quot;, line 610, in pymain_run_python (inlined) (/usr/lib/libpython3.8.so.1.0)
    (C) File &quot;Modules/main.c&quot;, line 385, in pymain_run_file (inlined) (/usr/lib/libpython3.8.so.1.0)
    (C) File &quot;Python/pythonrun.c&quot;, line 472, in PyRun_SimpleFileExFlags (/usr/lib/libpython3.8.so.1.0)
    (C) File &quot;Python/pythonrun.c&quot;, line 439, in pyrun_simple_file (inlined) (/usr/lib/libpython3.8.so.1.0)
    (C) File &quot;Python/pythonrun.c&quot;, line 1085, in pyrun_file (/usr/lib/libpython3.8.so.1.0)
    (C) File &quot;Python/pythonrun.c&quot;, line 1188, in run_mod (/usr/lib/libpython3.8.so.1.0)
    (C) File &quot;Python/pythonrun.c&quot;, line 1166, in run_eval_code_obj (/usr/lib/libpython3.8.so.1.0)
    (Python) File &quot;/test.py&quot;, line 17, in &lt;module&gt;
        first_func()
    (C) File &quot;Python/ceval.c&quot;, line 4963, in call_function (inlined) (/usr/lib/libpython3.8.so.1.0)
    (C) File &quot;Objects/call.c&quot;, line 284, in function_code_fastcall (inlined) (/usr/lib/libpython3.8.so.1.0)
    (Python) File &quot;/test.py&quot;, line 6, in first_func
        second_func()
    (C) File &quot;Python/ceval.c&quot;, line 4963, in call_function (inlined) (/usr/lib/libpython3.8.so.1.0)
    (C) File &quot;Objects/call.c&quot;, line 284, in function_code_fastcall (inlined) (/usr/lib/libpython3.8.so.1.0)
    (Python) File &quot;/test.py&quot;, line 10, in second_func
        third_func()
    (C) File &quot;Python/ceval.c&quot;, line 4963, in call_function (inlined) (/usr/lib/libpython3.8.so.1.0)
    (C) File &quot;Objects/call.c&quot;, line 284, in function_code_fastcall (inlined) (/usr/lib/libpython3.8.so.1.0)
    (Python) File &quot;/test.py&quot;, line 14, in third_func
        time.sleep(1000)
    (C) File &quot;Python/ceval.c&quot;, line 4963, in call_function (inlined) (/usr/lib/libpython3.8.so.1.0)
    (C) File &quot;Modules/timemodule.c&quot;, line 338, in time_sleep (/usr/lib/libpython3.8.so.1.0)
    (C) File &quot;Modules/timemodule.c&quot;, line 1866, in pysleep (inlined) (/usr/lib/libpython3.8.so.1.0)
    (C) File &quot;???&quot;, line 0, in __select ()
</pre></div>
</div>
</section>
<section id="locals">
<h2>Locals<a class="headerlink" href="#locals" title="Permalink to this heading">#</a></h2>
<p>In some scenarios knowing the stack trace is not enough to understand the internal state of the program. For instance, a given
function can do very different things depending on the provided arguments or different code paths can be taken depending on the
value of some local variable. In these cases, you can use <code class="docutils literal notranslate"><span class="pre">--locals</span></code> to obtain a simple string representation of the local variables
in the different frames as well as the function arguments:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ pystack remote 117 --locals
Traceback for thread 117 [] (most recent call last):
    (Python) File &quot;/test.py&quot;, line 19, in &lt;module&gt;
        first_func({1: None}, [1,2,3])
    (Python) File &quot;/test.py&quot;, line 7, in first_func
        second_func(x, y)
      Arguments:
        y: [1, 2, 3]
        x: {1: None}
      Locals:
        some_variable: &quot;hello from pystack&quot;
    (Python) File &quot;/test.py&quot;, line 12, in second_func
        third_func(x, y)
      Arguments:
        y: [1, 2, 3]
        x: {1: None}
      Locals:
        answer: 42
    (Python) File &quot;/test.py&quot;, line 16, in third_func
        time.sleep(1000)
      Arguments:
        y: [1, 2, 3]
        x: {1: None}
</pre></div>
</div>
<p>Only certain types of local variables can be printed this way, but most of the common built-in types can.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">--locals</span></code> can slightly increase the time required to generate a report due to the amount of extra memory
that needs to be copied to display the local variables and function arguments. Is also advised not to use the <code class="docutils literal notranslate"><span class="pre">--no-block</span></code>
option in this case as the process may evolve too fast in the time <code class="docutils literal notranslate"><span class="pre">pystack</span></code> is fetching the local variables.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For the most complete view you can combine <code class="docutils literal notranslate"><span class="pre">--locals</span></code> with <code class="docutils literal notranslate"><span class="pre">--native</span></code> or <code class="docutils literal notranslate"><span class="pre">--native--all</span></code>.</p>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="changelog.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Changelog</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="corefile.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Analyzing core dumps</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Customizing the reports</a><ul>
<li><a class="reference internal" href="#native-traces">Native traces</a></li>
<li><a class="reference internal" href="#locals">Locals</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=b3ba4146"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>